package com.example.widgetdemo;

import android.app.PendingIntent;
import android.appwidget.AppWidgetManager;
import android.appwidget.AppWidgetProvider;
import android.content.ComponentName;
import android.content.Context;
import android.content.Intent;
import android.widget.RemoteViews;

public class MyWidgetProvider extends AppWidgetProvider {

	@Override
	public void onUpdate(Context context, AppWidgetManager appWidgetManager,
			int[] appWidgetIds) {

		RemoteViews remoteViews = new RemoteViews(context.getPackageName(),
				R.layout.activity_home);
		
		
		for(int j = 0; j < appWidgetIds.length; j++) 
		{
		    int appWidgetId = appWidgetIds[j];

		    try {
		        Intent intent = new Intent("android.intent.action.MAIN");
		        intent.addCategory("android.intent.category.LAUNCHER");

		        intent.addFlags(Intent.FLAG_ACTIVITY_NO_ANIMATION);
		        intent.setComponent(new ComponentName(com.,
		            "fully qualified name of main activity of the app"));
		        PendingIntent pendingIntent = PendingIntent.getActivity(
		            context, 0, intent, 0);
		        RemoteViews views = new RemoteViews(context.getPackageName(),
		            layout id);
		        views.setOnClickPendingIntent(view Id on which onclick to be handled, pendingIntent);
		    appWidgetManager.updateAppWidget(appWidgetId, views);
		    } catch (ActivityNotFoundException e) {
		            Toast.makeText(context.getApplicationContext(),
		                    "There was a problem loading the application: ",
		                    Toast.LENGTH_SHORT).show();
		    }

		}
		
		remoteViews.setOnClickPendingIntent(R.id.widget_button,
				buildButtonPendingIntent(context));

		pushWidgetUpdate(context, remoteViews);

	}

	 public static PendingIntent buildButtonPendingIntent(Context context) {
		Intent intent = new Intent();
		intent.setAction("pl.looksok.intent.action.CHANGE_PICTURE");
		return PendingIntent.getBroadcast(context, 0, intent,
				PendingIntent.FLAG_UPDATE_CURRENT);
	}

	static void pushWidgetUpdate(Context context, RemoteViews remoteViews) {

		ComponentName myWidget = new ComponentName(context,
				MyWidgetProvider.class);
		AppWidgetManager manager = AppWidgetManager.getInstance(context);
		manager.updateAppWidget(myWidget, remoteViews);
	}

}
